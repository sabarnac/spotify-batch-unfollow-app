"use strict";(self.webpackChunkspotify_batch_unfollow_app=self.webpackChunkspotify_batch_unfollow_app||[]).push([[807],{127:(t,e,s)=>{s.d(e,{h:()=>n});const n=t=>null===t||void 0===t},379:(t,e,s)=>{s.d(e,{pn:()=>H,_d:()=>$,KM:()=>q});var n=s(43);const a=function(t,e){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i];const[o,r]=(0,n.useState)(),[c,u]=(0,n.useState)(),[l,f]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!e)return;f(!0),r(void 0),u(void 0);let s=!1;return(async()=>{try{const e=await t(...a);s||r(e),f(!1)}catch(c){const e=c;"AbortError"===e.name||s||u(e),f(!1)}})(),()=>{s=!0}},[t,e,...a]),[o,l,c]},i=function(t,e){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i];const[o,r]=(0,n.useState)([]),[c,u]=(0,n.useState)(),[l,f]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(!e)return;f(!0),r([]),u(void 0);let s=!1;return(async()=>{try{for await(const e of t(...a)){if(f(!0),s)break;r(t=>[...t,e])}f(!1)}catch(c){const e=c;"AbortError"===e.name||s||u(e),f(!1)}})(),()=>{s=!0}},[t,e,...a]),[o,l,c]};var o=s(127),r=s(154);const c=t=>t.json();class u extends Error{constructor(t,e,s){super(`Error has occurred performing the request due to error: ${e} [Status Code: ${t}]`),this._status=void 0,this._body=void 0,this._headers=void 0,this._status=t,this._body=e,this._headers=s}get status(){return this._status}get body(){return this._body}get headers(){return this._headers}}const l=async(t,e,s,n,a,i,o)=>{s.ok?t(s):n.attemptCount<n.maxAttemptCount&&d(s.status,o)?(n.attemptCount++,f(t,e,s,n,a,i,o)):e(new u(s.status,(await s.json()).error.message,s.headers))},f=(t,e,s,n,a,i,o)=>{setTimeout(async()=>{let s=await fetch(a,i);l(t,e,s,n,a,i,o)},((t,e)=>{const s=t.headers.get("Retry-After")||"0";return Math.max(1e3*Math.pow(2,e.attemptCount-1),Number(s))})(s,n))},d=(t,e)=>t>=500||e&&e.indexOf(t)>=0,y=async(t,e,s)=>new Promise(async(n,a)=>{l(n,a,await fetch(t,e),{attemptCount:0,maxAttemptCount:3},t,e,s)}),h=async(t,e,s,n,a)=>{const i=[r.sH,...t].join("/")+"/",c=(u=e)?"?"+Object.keys(u).filter(t=>!(0,o.h)(u[t])).map(t=>`${t}=${encodeURIComponent(u[t])}`).join("&"):"";var u;return y(i+c,((t,e,s)=>({headers:{Authorization:`Bearer ${r.Ay.userToken}`,...e},body:t,method:s}))(s,n,a),[429]).catch(t=>{throw 401!==t.status||r.Ay.resetToken(),t})},m=async(t,e,s)=>{const n=await c(await h(["me","following"],{type:t,limit:e,after:s}));return"artist"===t?n.artists:n.users},p=t=>"user"===t.type,w=async function*(t){let e;do{const s=await m(t,r.BU,e);yield s.items.map(t=>p(t)?{...t,name:t.display_name}:t),e=s.cursors.after}while(!(0,o.h)(e))},E=async(t,e)=>await c(await h(["me","shows"],{limit:t,offset:e})),g=async function*(){let t;do{const e=await E(r.BU,t);yield e.items.map(t=>{let{show:e}=t;return e}),t=e.offset+e.limit,t>=e.total&&(t=void 0)}while(!(0,o.h)(t))},v=async()=>c(await h(["me"])),j=(t,e)=>{let s=[];for(let n=0;n<t.length;n+=e)s.push(t.slice(n,Math.min(t.length,n+e)));return s},b=async t=>await h(["me","following"],{type:"artist",ids:t.map(t=>t.id).join(",")},null,{"Content-Type":"application/json"},"DELETE"),_=async function*(t){for(const s of j(t,r.BU))try{await b(s),yield{succeeded:s}}catch(e){yield{failed:s,error:e}}},T=async t=>await h(["me","shows"],{ids:t.map(t=>t.id).join(",")},null,{"Content-Type":"application/json"},"DELETE"),C=async function*(t){for(const s of j(t,r.BU))try{await T(s),yield{succeeded:s}}catch(e){yield{failed:s,error:e}}},S=async t=>await h(["me","following"],{type:"user",ids:t.map(t=>t.id).join(",")},null,{"Content-Type":"application/json"},"DELETE"),A=async function*(t){for(const s of j(t,r.BU))try{await S(s),yield{succeeded:s}}catch(e){yield{failed:s,error:e}}};var x=s(752);const U=async(t,e)=>await c(await h(["me","albums"],{limit:t,offset:e})),B=async function*(){let t;do{const e=await U(r.BU,t);yield e.items.map(t=>{let{album:e}=t;return e}),t=e.offset+e.limit,t>=e.total&&(t=void 0)}while(!(0,o.h)(t))},M=async t=>await h(["me","albums"],{ids:t.map(t=>t.id).join(",")},null,{"Content-Type":"application/json"},"DELETE"),k=async function*(t){for(const s of j(t,r.BU))try{await M(s),yield{succeeded:s}}catch(e){yield{failed:s,error:e}}},L=async(t,e,s)=>await c(await h(["users",t.id,"playlists"],{limit:e,offset:s})),N=async function*(){const t=await v();let e;do{const s=await L(t,r.BU,e);yield s.items.filter(e=>{let{owner:{id:s}}=e;return s!==t.id}),e=s.offset+s.limit,e>=s.total&&(e=void 0)}while(!(0,o.h)(e))},D=async t=>await h(["playlists",t.id,"followers"],void 0,null,{"Content-Type":"application/json"},"DELETE"),R=async function*(t){for(const s of t)try{await D(s),yield{succeeded:[s]}}catch(e){yield{failed:[s],error:e}}},$=function(){return a(v,!(arguments.length>0&&void 0!==arguments[0])||arguments[0])},I=(t,e,s)=>{if(0===s.length)return;const n=s[s.length-1];t(t=>[...t,...n]),e(...n)},O=(t,e)=>{e&&t(t=>[...t,e])},H=function(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[a,o,r]=i(w,s&&t.includes("ARTIST"),"artist"),[c,u,l]=i(w,s&&t.includes("USER"),"user"),[f,d,y]=i(g,s&&t.includes("SHOW")),[h,m,p]=i(B,s&&t.includes("ALBUM")),[E,v,j]=i(N,s&&t.includes("PLAYLIST")),[b,_]=(0,n.useState)([]);(0,n.useEffect)(()=>I(_,e,a),[a,e,_]),(0,n.useEffect)(()=>I(_,e,c),[c,e,_]),(0,n.useEffect)(()=>I(_,e,f),[f,e,_]),(0,n.useEffect)(()=>I(_,e,h),[h,e,_]),(0,n.useEffect)(()=>I(_,e,E),[E,e,_]);const[T,C]=(0,n.useState)([]);return(0,n.useEffect)(()=>O(C,r),[r,C]),(0,n.useEffect)(()=>O(C,l),[l,C]),(0,n.useEffect)(()=>O(C,y),[y,C]),(0,n.useEffect)(()=>O(C,p),[p,C]),(0,n.useEffect)(()=>O(C,j),[j,C]),(0,n.useEffect)(()=>{const e=(0,x.or)(...t);_(t=>t.filter(t=>{let{type:s}=t;return e.includes(s)}))},[t,_,C]),[b,o||u||d||m||v,T]},P=(t,e,s)=>{if(0===s.length)return;const n=s[s.length-1];t(t=>[...t,n]),e(n)},q=function(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=(0,n.useMemo)(()=>t.filter(t=>"artist"===t.type),[t]),o=(0,n.useMemo)(()=>t.filter(t=>"user"===t.type),[t]),r=(0,n.useMemo)(()=>t.filter(t=>"show"===t.type),[t]),c=(0,n.useMemo)(()=>t.filter(t=>"album"===t.type),[t]),u=(0,n.useMemo)(()=>t.filter(t=>"playlist"===t.type),[t]),[l,f,d]=i(_,s,a),[y,h,m]=i(A,s,o),[p,w,E]=i(C,s,r),[g,v,j]=i(k,s,c),[b,T,S]=i(R,s,u),[x,U]=(0,n.useState)([]);(0,n.useEffect)(()=>P(U,e,l),[l,e,U]),(0,n.useEffect)(()=>P(U,e,y),[y,e,U]),(0,n.useEffect)(()=>P(U,e,p),[p,e,U]),(0,n.useEffect)(()=>P(U,e,g),[g,e,U]),(0,n.useEffect)(()=>P(U,e,b),[b,e,U]);const[B,M]=(0,n.useState)([]);return(0,n.useEffect)(()=>O(M,d),[d,M]),(0,n.useEffect)(()=>O(M,m),[m,M]),(0,n.useEffect)(()=>O(M,E),[E,M]),(0,n.useEffect)(()=>O(M,j),[j,M]),(0,n.useEffect)(()=>O(M,S),[S,M]),[x,f||h||w||v||T,B]}},807:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var n=s(379),a=s(579);const i=()=>{const[t,e,s]=(0,n._d)();return(0,a.jsx)("div",{className:"user",children:s?(0,a.jsxs)("div",{className:"error",children:["Error retrieving user info: ",s.message]}):e?(0,a.jsx)("div",{className:"warning",children:"Retrieving user info"}):t?(0,a.jsxs)("div",{className:"info",children:["Logged in as: ",(0,a.jsx)("strong",{children:t.id})]}):(0,a.jsx)("div",{className:"error",children:"Not logged in"})})}}}]);
//# sourceMappingURL=807.250209d9.chunk.js.map